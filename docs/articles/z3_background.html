<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3 - Background tab • trackR</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="3 - Background tab">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">trackR</a>
        <span class="label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/z1_install.html">1 - Installing trackR</a>
    </li>
    <li>
      <a href="../articles/z2_video.html">2 - Video tab</a>
    </li>
    <li>
      <a href="../articles/z3_background.html">3 - Background tab</a>
    </li>
    <li>
      <a href="../articles/z4_mask.html">4 - Mask tab</a>
    </li>
    <li>
      <a href="../articles/z5_blob.html">5 - Blob tab</a>
    </li>
    <li>
      <a href="../articles/z6_tracking.html">6 - Tracking tab</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/swarm-lab/trackR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>3 - Background tab</h1>
                        <h4 class="author">Simon Garnier</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/swarm-lab/trackR/blob/master/vignettes/z3_background.Rmd"><code>vignettes/z3_background.Rmd</code></a></small>
      <div class="hidden name"><code>z3_background.Rmd</code></div>

    </div>

    
    
<p><code>trackR</code> uses two different algorithms in order to isolate objects from their surrounding background:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Background subtraction</strong>: this method consists in subtracting an image representing a fixed background from each frame of the video. Pixels with high values in the resulting image will correspond to objects moving in front of the background.</li>
<li>
<strong>Adaptive thresholding</strong>: this method consists in setting all pixels whose intensities are above a threshold to white and all the remaining pixels to black. In conventional thresholding, the threshold value is the same for all pixels. In adaptive thresholding however, the threshold changes dynamically over the image and is based on the local contrast between each pixel and its immediate surrounding. This allows for the easy detection of dark objects on a light background, and vice versa.</li>
</ol>
<p>The first method is usually more precise for object detection, but it requires that the background remains fixed for the entire duration of the experiment. The second method does not require that the background remains fixed, as long as the objects to track are always darker (resp. lighter) than their lighter (resp. darker) background. Which method you should choose will depend on the recording conditions of your experiment.</p>
<p>If you choose to use adaptive thresholding, you can skip this section and move directly to the next step. If you choose background subtraction, please follow the instructions below to load a background image (if you have recorded one) or create one from the video.</p>
<hr>
<ul>
<li><a href="#using-an-existing-background-image">1 - Using an existing background image</a></li>
<li><a href="#creating-a-background-image-from-the-video">2 - Creating a background image from the video</a></li>
<li><a href="#removing-ghosts">3 - Removing ghosts</a></li>
</ul>
<hr>
<center>
<img src="../man/figures/background.png" style="width:50.0%">
</center>
<hr>
<div id="using-an-existing-background-image" class="section level2">
<h2 class="hasAnchor">
<a href="#using-an-existing-background-image" class="anchor"></a>1 - Using an existing background image</h2>
<p>If you have recorded a background image of your experimental setup, or if you have created and saved one following the instructions in the <a href="#creating-a-background-image-from-the-video">next section</a>, you can load it by clicking on the <code>Select background file or...</code> button in the <code>Background</code> tab (see screenshot above). This will bring up a file navigator. Use the file navigator to locate and select the background image that you would like to use. If the image is correctly loaded in <code>trackR</code>, it should appear in the display window.</p>
<p>Note: the background image should have the same dimensions as the video.</p>
<hr>
</div>
<div id="creating-a-background-image-from-the-video" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-background-image-from-the-video" class="anchor"></a>2 - Creating a background image from the video</h2>
<p>If you do not have recorded a background image or want to create one from the video, you first need to select the number of video frames you would like to use for estimating the background. You can do this using the <code>Number of frames</code> slider in the <code>Background</code> tab (see screenshot above). Selecting more images will usually lead to a more accurate result, but will take longer.</p>
<p>Once you have selected a number of frames, you need to select the type of algorithms that you would like to use for estimating the background image. Two algorithms are available in <code>trackR</code>:</p>
<ol style="list-style-type: decimal">
<li>
<code>Mean</code>: this calculates an average image from the selected video frames. This is a fast algorithm. However it does not always produce good results.</li>
<li>
<code>Median</code>: this calculates a median image from the selected video frames. This usually produces a better result than <code>Mean</code>, but will take a significantly longer amount of time.</li>
</ol>
<p>You can select the algorithm using the <code>Type</code> dropdown menu. You can then click on the <code>...Estimate background</code> button to start the computation of the background image.</p>
<p>Once the background image is estimated, it should appear in the display window. You can save this image for later use by clicking on the <code>Save background file</code> button.</p>
<hr>
</div>
<div id="removing-ghosts" class="section level2">
<h2 class="hasAnchor">
<a href="#removing-ghosts" class="anchor"></a>3 - Removing ghosts</h2>
<p>In some instance (e.g. when an object does not move for a significant portion of the video), the background image may contain “ghosts”. To remove a ghost, click on the <code>Select ghost for removal</code> button in the <code>Background</code> tab (see screenshot above). Then, use left-mouse clicks in the display window to draw a polygon around the ghost you want to remove (see image below for an example). Close the polygon using a right-mouse click. <code>trackR</code> will then use an inpainting algorithm to remove the ghost from the background image.</p>
<hr>
<center>
<img src="../man/figures/ghost.png" style="width:75.0%">
</center>
<hr>
<p>Repeat this operation as many times as necessary to remove all the unwanted ghosts.</p>
<p>Note: inpainting is not an exact science and the result of removing ghosts may not be satisfying. In this case, use a more advanced image editing program such as Adobe Photoshop or Gimp to clean up your background image.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#using-an-existing-background-image">1 - Using an existing background image</a></li>
      <li><a href="#creating-a-background-image-from-the-video">2 - Creating a background image from the video</a></li>
      <li><a href="#removing-ghosts">3 - Removing ghosts</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://www.theswarmlab.com">Simon Garnier</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script>
  docsearch({
    
    
    apiKey: '5cc7571ea2edfcf1062359e583eb942a',
    indexName: 'swarm-lab-trackr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
